-- Feel free to change anything you want :)

local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("LancelotTroll", "Sentinel")

local Players = game:GetService("Players")

local function createNotification()
    local player = Players.LocalPlayer
    player:WaitForChild("PlayerGui")

    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "GUI Loaded",
        Text = "Made By AgentLancelot",
        Duration = 5,
        Icon = "rbxassetid://10878730168"
    })
end

createNotification()

local players = {}
local Select = nil
local killAllEnabled = false
local killPlayerEnabled = false
local keybindsDisabled = false
local loopJumpscarePlayerEnabled = false
local loopJumpscareAllEnabled = false
local killAllCrashEnabled = false

local function refreshPlayerList()
    players = {}
    for _, v in pairs(Players:GetPlayers()) do
        table.insert(players, v.Name)
    end
end

local killTab = Window:NewTab("Kill All")
local killSection = killTab:NewSection("Features")

refreshPlayerList() -- Initial population of the player list

local playerDropdown -- Variable to hold the dropdown

local function updateDropdown()
    if playerDropdown then
        playerDropdown:Refresh(players)
    else
        playerDropdown = killSection:NewDropdown("Select Player", "Select a player to target", players, function(abc)
            Select = abc
        end)
    end
end

updateDropdown()

killSection:NewButton("Refresh", "Refresh player list", function()
    refreshPlayerList()
    updateDropdown()
end)

local function killPlayer(playerName)
    while killPlayerEnabled do
        task.wait()
        local targetPlayer = Players:FindFirstChild(playerName)
        if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local args = { [1] = targetPlayer.Character }
            game:GetService("ReplicatedStorage").Characters.Combat.Remotes.Combo:FireServer(unpack(args))
        else
            print("Target player not found or does not have a character.")
            killPlayerEnabled = false
        end
    end
end

killSection:NewToggle("Kill Player", "Toggle to kill selected player", function(state)
    killPlayerEnabled = state
    if killPlayerEnabled then
        if Select then
            print("Killing player: " .. Select)
            killPlayer(Select)
        else
            print("No valid target player selected.")
            killPlayerEnabled = false
        end
    else
        print("Stopped killing selected player.")
    end
end)

local function killAllPlayers()
    while killAllEnabled do
        task.wait(0.3)
        pcall(function()
            for i, v in pairs(Players:GetPlayers()) do
                if v ~= Players.LocalPlayer then
                    v.Character:PivotTo(Players.LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, -5))
                    game:GetService("ReplicatedStorage").Characters.Combat.Remotes.Combo:FireServer(v.Character)
                end
            end
        end)
    end
end

killSection:NewToggle("Kill All", "Toggle to kill all players", function(state)
    killAllEnabled = state
    if killAllEnabled then
        print("Killing all players.")
        killAllPlayers()
    else
        print("Stopped killing all players.")
    end
end)

local function killAllPlayersCrash()
    while killAllCrashEnabled do
        task.wait()
        pcall(function()
            for i, v in pairs(Players:GetPlayers()) do
                if v ~= Players.LocalPlayer then
                    v.Character:PivotTo(Players.LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, -5))
                    game:GetService("ReplicatedStorage").Characters.Combat.Remotes.Combo:FireServer(v.Character)
                end
            end
        end)
    end
end

killSection:NewToggle("Kill All (Crashes the server)", "Toggle to kill all players (may crash the server)", function(state)
    killAllCrashEnabled = state
    if killAllCrashEnabled then
        print("Killing all players (may crash the server).")
        killAllPlayersCrash()
    else
        print("Stopped killing all players.")
    end
end)

local jumpscareTab = Window:NewTab("Jumpscare All")
local jumpscareSection = jumpscareTab:NewSection("Features")

local jumpscareDropdown

local function updateJumpscareDropdown()
    if jumpscareDropdown then
        jumpscareDropdown:Refresh(players)
    else
        jumpscareDropdown = jumpscareSection:NewDropdown("Select Player", "Select a player to jumpscare", players, function(abc)
            Select = abc
        end)
    end
end

updateJumpscareDropdown()

jumpscareSection:NewButton("Refresh", "Refresh player list", function()
    refreshPlayerList()
    updateJumpscareDropdown()
end)

local function jumpscarePlayer(playerName)
    local targetPlayer = Players:FindFirstChild(playerName)
    if targetPlayer and targetPlayer.Character then
        local args = { [1] = targetPlayer.Character }
        game:GetService("ReplicatedStorage"):WaitForChild("Characters"):WaitForChild("Moonknight"):WaitForChild("Remotes"):WaitForChild("Grapplehit"):FireServer(unpack(args))
    else
        print("Target player not found or does not have a character.")
    end
end

jumpscareSection:NewButton("Jumpscare Player (Press Option)", "Press to jumpscare selected player", function()
    if Select then
        jumpscarePlayer(Select)
    else
        print("No valid target player selected for jumpscare.")
    end
end)

local loopJumpscarePlayer = function()
    while loopJumpscarePlayerEnabled do
        task.wait(0.1)
        if Select then
            jumpscarePlayer(Select)
        end
    end
end

jumpscareSection:NewToggle("Loop Jumpscare Player", "Toggle to loop jumpscare selected player", function(state)
    loopJumpscarePlayerEnabled = state
    if loopJumpscarePlayerEnabled then
        print("Loop Jumpscare Player enabled.")
        loopJumpscarePlayer()
    else
        print("Loop Jumpscare Player disabled.")
    end
end)

jumpscareSection:NewButton("Jumpscare Yourself", "Press to jumpscare yourself", function()
    jumpscarePlayer(Players.LocalPlayer.Name)
end)

jumpscareSection:NewButton("Jumpscare All", "Press to jumpscare all players", function()
    for _, player in pairs(Players:GetPlayers()) do
        if player and player.Character and player ~= Players.LocalPlayer then
            jumpscarePlayer(player.Name)
        end
    end
end)

local loopJumpscareAll = function()
    while loopJumpscareAllEnabled do
        task.wait(0.1)
        for _, player in pairs(Players:GetPlayers()) do
            if player and player.Character and player ~= Players.LocalPlayer then
                jumpscarePlayer(player.Name)
            end
        end
    end
end

jumpscareSection:NewToggle("Loop Jumpscare All", "Toggle to loop jumpscare all players", function(state)
    loopJumpscareAllEnabled = state
    if loopJumpscareAllEnabled then
        print("Loop Jumpscare All enabled.")
        loopJumpscareAll()
    else
        print("Loop Jumpscare All disabled.")
    end
end)

jumpscareSection:NewToggle("Disable Keybinds", "Toggle to disable jumpscare keybinds", function(state)
    keybindsDisabled = state
    if keybindsDisabled then
        print("Jumpscare keybinds disabled.")
    else
        print("Jumpscare keybinds enabled.")
    end
end)

local UserInputService = game:GetService("UserInputService")
UserInputService.InputBegan:Connect(function(input, gameProcessedEvent)
    if not gameProcessedEvent then
        if input.KeyCode == keybindKey and not keybindsDisabled then
            if Select then
                jumpscarePlayer(Select)
            else
                print("No valid target player selected for jumpscare.")
            end
        end
    end
end)

local bringAllTab = Window:NewTab("Bring All")
local bringAllSection = bringAllTab:NewSection("Features")

local bringAllDropdown

local function updateBringAllDropdown()
    if bringAllDropdown then
        bringAllDropdown:Refresh(players)
    else
        bringAllDropdown = bringAllSection:NewDropdown("Select Player", "Select a player to bring all players to", players, function(abc)
            Select = abc
        end)
    end
end

updateBringAllDropdown()

bringAllSection:NewButton("Refresh", "Refresh player list", function()
    refreshPlayerList()
    updateBringAllDropdown()
end)

local function bringPlayer(playerName)
    local targetPlayer = Players:FindFirstChild(playerName)
    if targetPlayer and targetPlayer.Character then
        local args = { [1] = targetPlayer.Character }
        game:GetService("ReplicatedStorage"):WaitForChild("Characters"):WaitForChild("MrFantastic"):WaitForChild("Remotes"):WaitForChild("StretchGrab"):FireServer(unpack(args))
    else
        print("Target player not found or does not have a character.")
    end
end

bringAllSection:NewButton("Bring Player (Need Mr Fantastic)", "Press to bring selected player", function()
    if Select then
        bringPlayer(Select)
    else
        print("No valid target player selected for bring.")
    end
end)

local function bringAllPlayers()
    local players = game:GetService("Players")
    local remote = game:GetService("ReplicatedStorage"):WaitForChild("Characters"):WaitForChild("MrFantastic"):WaitForChild("Remotes"):WaitForChild("StretchGrab")

    for _, player in ipairs(players:GetPlayers()) do
        local character = player.Character
        if character then
            local args = { [1] = character }
            remote:FireServer(unpack(args))
        end
    end
end

bringAllSection:NewButton("Bring All (Need Mr Fantastic)", "Press to bring all players", function()
    bringAllPlayers()
end)

local function teleportTo(location)
    local player = Players.LocalPlayer
    if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        player.Character.HumanoidRootPart.CFrame = location.CFrame
    else
        print("Local player not found or does not have a character.")
    end
end

local teleportsSection = bringAllTab:NewSection("Teleports")

teleportsSection:NewButton("Teleport to the main menu house", "Teleport to the main menu house", function()
    local mainMenuHouse = Workspace.FakeChars.FakeHumanoidRootPart
    teleportTo(mainMenuHouse)
end)

teleportsSection:NewButton("Teleport to the NukeHold", "Teleport to the NukeHold", function()
    local nukeHold = Workspace.NukeHold
    teleportTo(nukeHold)
end)

teleportsSection:NewButton("Teleport to the Lobby", "Teleport to the lobby", function()
    local lobbyPart = Workspace.Lobby:GetChildren()[5]
    if lobbyPart and lobbyPart:IsA("BasePart") then
        teleportTo(lobbyPart)
    else
        print("Specified part not found in Lobby.")
    end
end)

local uiTab = Window:NewTab("UI")
local uiSection = uiTab:NewSection("UI")
uiSection:NewKeybind("Hide UI", "KeybindInfo", Enum.KeyCode.N, function()
    Library:ToggleUI()
end)
-- Feel free to change anything you want :)

